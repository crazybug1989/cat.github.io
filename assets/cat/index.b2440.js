window.__require=function t(e,o,a){function n(i,c){if(!o[i]){if(!e[i]){var s=i.split("/");if(s=s[s.length-1],!e[s]){var d="function"==typeof __require&&__require;if(!c&&d)return d(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+i+"'")}i=s}var u=o[i]={exports:{}};e[i][0].call(u.exports,function(t){return n(e[i][1][t]||t)},u,u.exports,t,e,o,a)}return o[i].exports}for(var r="function"==typeof __require&&__require,i=0;i<a.length;i++)n(a[i]);return n}({catSubPart:[function(t,e,o){"use strict";cc._RF.push(e,"754c20nR7dA4robJi/FdHkW","catSubPart");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,a){var n,r=arguments.length,i=r<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(i=(r<3?n(i):r>3?n(e,o,i):n(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../../framework/data/cat/catData"),c=t("../../../framework/db/db"),s=t("../../../framework/plugin/utils/utilBundle"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.image=null,e.data=null,e}return n(e,t),e.prototype.init=function(t){var e=this;this.data=i.catData.instance.subPartMap[t],this.node.setPosition(this.data.position),s.utilBundle.instance.loadBundleRes(c.db.game.part[this.data.partId].bundleName,cc.SpriteFrame,"items/"+this.data.resUrl).then(function(t){e.image.getComponent(cc.Sprite).spriteFrame=t,e.node.width=e.image.node.width,e.node.height=e.image.node.height})},r([p(cc.Sprite)],e.prototype,"image",void 0),r([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../framework/data/cat/catData":void 0,"../../../framework/db/db":void 0,"../../../framework/plugin/utils/utilBundle":void 0}],cat:[function(t,e,o){"use strict";cc._RF.push(e,"6b58bX91NtL14PQXFrRKLQP","cat");var a,n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,a){var n,r=arguments.length,i=r<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(i=(r<3?n(i):r>3?n(e,o,i):n(e,o))||i);return r>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../../framework/data/cat/catData"),c=t("./catSubPart"),s=cc._decorator,d=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.subPartPrefab=null,e.subPartMap={},e.dragSubPartMap={},e.selectDragSubParts=null,e}return n(e,t),e.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStartHandler,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMoveHandler,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEndHandler,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancelHandler,this)},e.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStartHandler,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMoveHandler,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEndHandler,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancelHandler,this)},e.prototype.onTouchStartHandler=function(t){this.selectDragSubParts=[];var e=null,o=cc.Camera.findCamera(this.node).getScreenToWorldPoint(t.getLocation());for(var a in this.dragSubPartMap){var n=this.dragSubPartMap[a].node,r=n.convertToNodeSpaceAR(o);if(r.x>=-n.width*n.anchorX&&r.x<=n.width*(1-n.anchorX)&&r.y>=-n.height*n.anchorY&&r.y<=n.height*(1-n.anchorY)){e=this.dragSubPartMap[a];break}}e&&(this.selectDragSubParts=i.catData.instance.findLinkSubParts(e.data.id))},e.prototype.onTouchMoveHandler=function(t){if(0!==this.selectDragSubParts.length)for(var e=0;e<this.selectDragSubParts.length;e++){var o=this.subPartMap[this.selectDragSubParts[e]];o.node.setPosition(o.node.getPosition().add(t.getLocation().sub(t.getPreviousLocation()))),o.node.getChildByName("label").getComponent(cc.Label).string=o.data.partId+","+Math.floor(o.node.x)+","+Math.floor(o.node.y)}},e.prototype.onTouchEndHandler=function(){if(0!==this.selectDragSubParts.length)for(var t=0;t<this.selectDragSubParts.length;t++){var e=this.subPartMap[this.selectDragSubParts[t]];e.data.position=e.node.getPosition()}},e.prototype.onTouchCancelHandler=function(){if(0!==this.selectDragSubParts.length)for(var t=0;t<this.selectDragSubParts.length;t++){var e=this.subPartMap[this.selectDragSubParts[t]];e.data.position=e.node.getPosition()}},e.prototype.initWithData=function(t){var e=JSON.parse(t);for(var o in e.subPartMap)this.addSubPart(o)},e.prototype.removeSubPart=function(t){var e=this.subPartMap[t];e&&(e.data.dragEnable&&delete this.dragSubPartMap[t],e.node.removeFromParent(),delete this.subPartMap[t])},e.prototype.addSubPart=function(t){if(!this.subPartMap[t]){var e=cc.instantiate(this.subPartPrefab).getComponent(c.default);e.init(t);var o=cc.find(e.data.nodeUrl,this.node);o?(o.addChild(e.node),this.subPartMap[t]=e,e.data.dragEnable&&(this.dragSubPartMap[t]=e)):console.error("\u7236\u8282\u70b9\u67e5\u627e\u5931\u8d25")}},e.prototype.playAnimation=function(){this.node.getChildByName("node").getChildByName("face").getComponent(cc.Animation).play()},e.prototype.stopAnimation=function(){this.node.getChildByName("node").getChildByName("face").angle=0,this.node.getChildByName("node").getChildByName("face").getComponent(cc.Animation).stop()},e.prototype.viewState=function(){this.node.getChildByName("node").runAction(cc.moveTo(.2,cc.v2(0,-120)))},e.prototype.makeState=function(){this.node.getChildByName("node").runAction(cc.moveTo(.2,cc.v2(0,0)))},r([u(cc.Node)],e.prototype,"subPartPrefab",void 0),r([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../framework/data/cat/catData":void 0,"./catSubPart":"catSubPart"}]},{},["cat","catSubPart"]);